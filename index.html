<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ú–∞–≥–∞–∑–∏–Ω —Å–≤–µ—á–µ–π</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #fff8f0; }
    h1 { color: #333; }
    .item {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 8px;
      background: #fff;
    }
    button {
      margin-top: 5px;
      padding: 6px 10px;
      border: none;
      background-color: #d179b9;
      color: white;
      border-radius: 4px;
      cursor: pointer;
    }
    #cart {
      margin-top: 20px;
      padding-top: 10px;
      border-top: 1px solid #ccc;
    }
    input {
      margin: 4px 0;
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
    }
  </style>
</head>
<body>
  <h1>–ú–∞–≥–∞–∑–∏–Ω —Å–≤–µ—á–µ–π</h1>
  <div id="items"></div>

  <div id="cart">
    <h3>–ö–æ—Ä–∑–∏–Ω–∞</h3>
    <ul id="cart-list"></ul>
    <div>
      <label>–ì–æ—Ä–æ–¥:<br><input type="text" id="city" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, –•–∞–±–∞—Ä–æ–≤—Å–∫"></label><br>
      <label>–ê–¥—Ä–µ—Å:<br><input type="text" id="address" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞"></label><br>
      <label><input type="checkbox" id="pickup"> –°–∞–º–æ–≤—ã–≤–æ–∑</label><br><br>
      <button onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
    </div>
  </div>

  <script>
    Telegram.WebApp.ready();
    const BOT_TOKEN = '7987338974:AAFGe-sbPh3GFpnyVVv3nWgH9XQsZ2QH4t0';
    const ADMIN_ID = 319994578;

    const items = [
      { name: "–ù–∞ –¥–µ–Ω—å–≥–∏", price: 500 },
      { name: "–ù–∞ –ª—é–±–æ–≤—å", price: 500 },
      { name: "–ù–∞ –æ—á–∏—â–µ–Ω–∏–µ", price: 500 }
    ];

    const cart = [];
    const itemsDiv = document.getElementById('items');
    const cartList = document.getElementById('cart-list');

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
    items.forEach((item, i) => {
      const div = document.createElement('div');
      div.className = 'item';
      div.innerHTML = `
        <strong>${item.name}</strong>
        <p>—ç—Ç–∞ —Å–≤–µ—á–∞ –∏–∑–º–µ–Ω–∏—Ç —Ç–≤–æ—é –∂–∏–∑–Ω—å</p>
        <p>${item.price}‚ÇΩ</p>
        <button onclick="addToCart(${i})">–ö—É–ø–∏—Ç—å</button>
      `;
      itemsDiv.appendChild(div);
    });

    function addToCart(index) {
      cart.push(items[index]);
      updateCart();
    }

    function updateCart() {
      cartList.innerHTML = '';
      cart.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item.name + ' ‚Äî ' + item.price + '‚ÇΩ';
        cartList.appendChild(li);
      });
    }

    function checkout() {
      const city = document.getElementById('city').value.trim();
      const address = document.getElementById('address').value.trim();
      const pickup = document.getElementById('pickup').checked;

      const data = {
        items: cart,
        city: city || "–Ω–µ —É–∫–∞–∑–∞–Ω",
        address: pickup ? "–°–∞–º–æ–≤—ã–≤–æ–∑" : (address || "–Ω–µ —É–∫–∞–∑–∞–Ω")
      };

      const itemList = data.items.map(i => `‚Ä¢ ${i.name} ‚Äî ${i.price}‚ÇΩ`).join('\\n');
      const text = `üì¶ *–ù–æ–≤—ã–π –∑–∞–∫–∞–∑*\\n\\n` +
                   `üìç *–ì–æ—Ä–æ–¥:* ${data.city}\\n` +
                   `üè† *–ê–¥—Ä–µ—Å:* ${data.address}\\n` +
                   `üïØ *–¢–æ–≤–∞—Ä—ã:*\\n${itemList}`;

      fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
        method: 'POST',
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          chat_id: ADMIN_ID,
          text: text,
          parse_mode: "Markdown"
        })
      })
      .then(res => res.json())
      .then(res => {
        if (res.ok) {
          alert("‚úÖ –ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!");
          cart.length = 0;
          updateCart();
        } else {
          alert("‚ùå –û—à–∏–±–∫–∞ Telegram: " + JSON.stringify(res));
        }
      })
      .catch(err => {
        alert("üö´ –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: " + err.message);
      });
    }
  </script>
</body>
</html>
